<div class="max-w-3xl mx-auto my-4 bg-white rounded-lg shadow p-6">
  <h2 class="text-center mb-4 text-2xl font-semibold">Offer a Ride</h2>
  <form [formGroup]="rideForm" (ngSubmit)="submitRide()">
    @if(rideForm.invalid && rideForm.touched){
      <div class="mb-4 p-3 bg-red-50 border border-red-200 rounded text-red-800">
        Some fields are missing or invalid. Please check the form.
      </div>
    }

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-3">
      <div>
        <label class="block mb-1">Departure Location</label>
        <input
          type="text"
          formControlName="departureLocation"
          class="w-full border rounded px-3 py-2"
          [ngClass]="{ 'border-red-500': isInvalid('departureLocation') }"
        />
        <div *ngIf="isInvalid('departureLocation')" class="text-red-600 text-sm mt-1">Departure location is required.</div>
      </div>

      <div>
        <label class="block mb-1">Start Governorate</label>
        <select
          formControlName="startGovernorate"
          class="w-full border rounded px-3 py-2"
          [ngClass]="{ 'border-red-500': isInvalid('startGovernorate') }"
        >
          <option value="" disabled>Select governorate</option>
          @for(gov of governorates; track gov){
            <option [value]="gov">{{ gov }}</option>
          }
        </select>
        <div *ngIf="isInvalid('startGovernorate')" class="text-red-600 text-sm mt-1">Start governorate is required.</div>
      </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-3">
      <div>
        <label class="block mb-1">Departure Date</label>
        <input
          type="date"
          formControlName="departureDate"
          class="w-full border rounded px-3 py-2"
          [ngClass]="{ 'border-red-500': isInvalid('departureDate') }"
        />
        <div *ngIf="isInvalid('departureDate')" class="text-red-600 text-sm mt-1">Please select a valid date.</div>
      </div>

      <div>
        <label class="block mb-1">Departure Time</label>
        <input
          type="time"
          formControlName="departureTime"
          class="w-full border rounded px-3 py-2"
          [ngClass]="{ 'border-red-500': isInvalid('departureTime') }"
        />
        <div *ngIf="isInvalid('departureTime')" class="text-red-600 text-sm mt-1">Please select a valid time.</div>
      </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-3">
      <div>
        <label class="block mb-1">Destination</label>
        <input
          type="text"
          formControlName="destination"
          class="w-full border rounded px-3 py-2"
          [ngClass]="{ 'border-red-500': isInvalid('destination') }"
        />
        <div *ngIf="isInvalid('destination')" class="text-red-600 text-sm mt-1">Destination is required.</div>
      </div>

      <div>
        <label class="block mb-1">End Governorate</label>
        <select
          formControlName="endGovernorate"
          class="w-full border rounded px-3 py-2"
          [ngClass]="{ 'border-red-500': isInvalid('endGovernorate') }"
        >
          <option value="" disabled>Select governorate</option>
          @for(gov of governorates; track gov){
            <option [value]="gov">{{ gov }}</option>
          }
        </select>
        <div *ngIf="isInvalid('endGovernorate')" class="text-red-600 text-sm mt-1">End governorate is required.</div>
      </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-3">
      <div>
        <label class="block mb-1">Available Places</label>
        <input
          type="number"
          formControlName="availablePlaces"
          class="w-full border rounded px-3 py-2"
          [ngClass]="{ 'border-red-500': isInvalid('availablePlaces') }"
        />
        <div *ngIf="isInvalid('availablePlaces')" class="text-red-600 text-sm mt-1">Enter the number of available places (at least 1).</div>
      </div>

      <div>
        <label class="block mb-1">Price Per Seat</label>
        <input
          type="number"
          formControlName="pricePerSeat"
          class="w-full border rounded px-3 py-2"
          [ngClass]="{ 'border-red-500': isInvalid('pricePerSeat') }"
        />
        <div *ngIf="isInvalid('pricePerSeat')" class="text-red-600 text-sm mt-1">Enter a valid price.</div>
      </div>
    </div>

    <div class="mb-3">
      <label class="block mb-1">Comments</label>
      <textarea
        formControlName="comments"
        class="w-full border rounded px-3 py-2"
        rows="3"
      ></textarea>
    </div>

    <div id="map" class="mb-3 u-map-400"></div>
    <p>{{ instructions }}</p>

    <div class="flex justify-between mb-3 gap-2">
      <button type="button" class="px-3 py-1 rounded bg-warning text-black" (click)="resetStart()">Reset Start</button>
      <button type="button" class="px-3 py-1 rounded bg-warning text-black" (click)="resetEnd()">Reset End</button>
    </div>

    <button type="submit" class="w-full px-4 py-2 bg-primary text-white rounded">Create Ride</button>
  </form>
</div>
