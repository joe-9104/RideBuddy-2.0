<div class="max-w-7xl mx-5 my-7">
  <!-- Card -->
  <div class="bg-white rounded-2xl shadow-xl overflow-hidden">

    <!-- Header -->
    <div class="bg-gradient-to-r from-indigo-600 to-purple-600 p-6">
      <h2 class="text-2xl font-bold text-white">My Rides</h2>
      <p class="text-indigo-100 text-sm">Manage, filter, and track all your rides</p>
    </div>

    <!-- Filter Section -->
    <div class="p-6 border-b border-gray-200">
      <div class="flex flex-wrap items-center gap-3">

        <!-- Column Selection -->
        <select
          [(ngModel)]="filterColumn"
          class="px-4 py-2 border-2 border-gray-200 rounded-lg text-sm focus:outline-none focus:border-indigo-600 focus:ring-2 focus:ring-indigo-100 transition"
        >
          <option value="">-- Choose Column --</option>
          <option value="departureLocation">Departure Location</option>
          <option value="destination">Destination</option>
          <option value="departureTime">Departure Time</option>
          <option value="availablePlaces">Available Places</option>
          <option value="pricePerSeat">Price per Seat</option>
          <option value="status">Status</option>
        </select>

        <!-- Filter text -->
        <input
          [(ngModel)]="filterValue"
          type="text"
          class="px-4 py-2 border-2 border-gray-200 rounded-lg text-sm focus:outline-none focus:border-indigo-600 focus:ring-2 focus:ring-indigo-100 transition"
          placeholder="Filter value..."
        />

        <!-- Buttons -->
        <button
          class="px-4 py-2 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-lg text-sm font-semibold hover:shadow-lg transition"
          (click)="applyFilter()"
        >
          Apply Filter
        </button>

        <button
          class="px-4 py-2 bg-gray-500 text-white rounded-lg text-sm font-semibold hover:bg-gray-600 transition"
          (click)="resetFilter()"
        >
          Reset
        </button>
      </div>
    </div>

    <!-- Table -->
    <div class="overflow-x-auto">
      <table class="min-w-full text-sm">
        <thead>
        <tr class="bg-gray-100 border-b border-gray-200">
          <th class="px-4 py-3 text-left font-semibold text-gray-700">#</th>
          <th class="px-4 py-3 text-left font-semibold text-gray-700">Departure Location</th>
          <th class="px-4 py-3 text-left font-semibold text-gray-700">Destination</th>
          <th class="px-4 py-3 text-left font-semibold text-gray-700">Departure Time</th>
          <th class="px-4 py-3 text-left font-semibold text-gray-700">Available Places</th>
          <th class="px-4 py-3 text-left font-semibold text-gray-700">Price</th>
          <th class="px-4 py-3 text-left font-semibold text-gray-700">Status</th>
          <th class="px-4 py-3 text-center font-semibold text-gray-700">Map</th>
          <th class="px-4 py-3 text-left font-semibold text-gray-700">Actions</th>
        </tr>
        </thead>

        <tbody>
        <tr
          *ngFor="let ride of rides$ | async; let i = index"
          class="border-b border-gray-100 hover:bg-gray-50 transition"
          [ngClass]="{
              'bg-green-50': ride.status === 'over',
              'bg-gray-100': ride.status === 'canceled'
            }"
        >
          <td class="px-4 py-3">{{ i + 1 }}</td>
          <td class="px-4 py-3">{{ ride.departureLocation }}</td>
          <td class="px-4 py-3">{{ ride.destination }}</td>
          <td class="px-4 py-3">
            {{ ride.departureDate }} {{ ride.departureTime }}
          </td>
          <td class="px-4 py-3">{{ ride.availablePlaces }}</td>
          <td class="px-4 py-3">{{ ride.pricePerSeat }} TND</td>

          <td class="px-4 py-3">
              <span
                class="px-2 py-1 rounded-full text-xs font-semibold"
                [ngClass]="{
                  'bg-green-200 text-green-800': ride.status === 'over',
                  'bg-red-200 text-red-800': ride.status === 'canceled',
                  'bg-yellow-200 text-yellow-800': ride.status === 'in-progress' || !ride.status
                }"
              >
                {{ ride.status || 'in-progress' }}
              </span>
          </td>

          <td class="px-4 py-3 text-center">
            <a
              [routerLink]="['/dashboard/rides/ride-visualize', ride.id]"
              [state]="{ ride: ride }"
              class="px-2 py-1 border rounded-lg hover:bg-gray-100 transition inline-block"
            >
              <fa-icon [icon]="faMapLocation"></fa-icon>
            </a>
          </td>

          <td class="px-4 py-3 space-x-2">

            <button
              *ngIf="ride.status !== 'over' && ride.status !== 'canceled'"
              class="px-3 py-1 bg-yellow-400 text-black rounded-lg text-xs font-semibold hover:bg-yellow-500 transition"
              (click)="markAsOver(ride)"
            >
              Mark as Over
            </button>

            <button
              *ngIf="ride.status !== 'over' && ride.status !== 'canceled'"
              class="px-3 py-1 bg-red-600 text-white rounded-lg text-xs font-semibold hover:bg-red-700 transition"
              (click)="cancelRide(ride)"
            >
              Cancel
            </button>

          </td>
        </tr>
        </tbody>
      </table>
    </div>

    <!-- Footer -->
    <div class="px-6 py-4 bg-gray-50 border-t text-center text-sm text-gray-600">
      Manage your rides efficiently with RideBuddy ðŸš—âœ¨
    </div>
  </div>
</div>
